%#MAKEINDEX makeindex interim01
\documentclass[10pt,a4j]{jarticle}

\input{include/macro.tex}
\input{include/preamble.tex}

\begin{document}
\input{include/titlepage.tex}

\newpage
\section{目的}
学部3年までに学習した制御理論や電気回路，
情報工学の知識を使って, 競技場内を自律的に走行するロボットカーの製作を行う．
各研究室でチーム一丸となってプロジェクトを進行し，
共同で課題を達成することの難しさや楽しさを学び，
エンジニアとして仕事を進めるための素養を身に付ける．
情報工学の知識を使って, 競技場内を自律的に走行するロボットカーの製作を行う．
各研究室でチーム一丸となってプロジェクトを進行し，
共同で課題を達成することの難しさや楽しさを学び，


\section{Robot Car Race(RCR)2017競技ルール}
\subsection{ルール概要}
競技場には黄色のポールや,火災に見立てた複数の赤色のポールが設置されている．
ポールに接触せず，できるだけ速やかに火災を鎮火させる
消防ロボットカー(ロボカー)を作成する．

\subsection{競技場詳細}
競技場の全体図を図\ref{course}に示し,以下に詳細を説明する．
\begin{enumerate}
  \item 競技場は板張りの床であり，縦・横ともに $5400\unit{mm}$である．

  \item 競技場には黄色の固定ポールと赤色の火災ポールが設置されており，
        スタートからゴールまで，固定ポールには接触，
        火災ポールには衝突することなく通過しなければならない．

  \item 火災ポールは青色の鎮火ポールに赤色の幕を被せたものであり，
        上部におもりなどを落としたり，幕を剥がしたりすることで，
        鎮火ポールに変化させる(このポールの製作も行うこと)．

  \item スタート後は右手に固定ポールを見ながら直進し，
        消火活動開始区間まで移動しなければならない．消火活動開始区間に
        進入後は，右折し，火災ポールを発見し次第，消火にあたる．

  \item すべての火災ポールを消火して，鎮火ポールに変化させたのち，
        ゴール地点で停止する．

  \item 火災ポールの配置は競技ごとに異なる．
        また，鎮火ポールが存在することもある．

  \item ポールは直径 $80\unit{mm}$・高さ $120\unit{mm}$の中空パイプであり，
        黄・赤・青の色が付けられている．
\end{enumerate}

\begin{figure}[t]
  \begin{center}
    \includegraphics[width=1.0\hsize]{picture/course.eps}
    \caption{2017年度 RCR走行コース}
    \label{course}
  \end{center}
\end{figure}


\newpage
\section{ロボットカーの概要}
本年度のRCRでの我々の設計コンセプトは，
ロボットの安定した運用を可能にすることである，
そのために，ロボットカーには比較的構造が単純な独立二輪機構を採用する．
火災・鎮火ポールの判別は，ロボット前方に取り付けた単眼カメラの映像を
画像処理することで行う，また，PSD(Position Sensitive Detector)センサと
赤外線近接センサを用いてポールとロボットの距離を測定することで，
適切な軌道の走行とポールの消火を目指す．
製作にあたっては，研究室のメンバーをハードウェア，ソフトウェアの
担当に分けて進めることとする．


\section{消火について}
\subsection{消火ポール}
我々が用いる消火ポールは，以下のように製作する．\\
まず，塩化ビニル管に青い布を巻きつけて青いポールを作成する．
次に，青いポールの上から赤い布を覆うことで赤いポールとする．


\subsection{消火方法}
用いるポールの構造より，赤い布を青いポールから取り除くことで消火とする．
布を取り除く方法は，ロボットアームがポールの上から赤い布を
中に押し込んで，青いポールにするというものである．





\section{PSDセンサの同定実験}
\label{psdex}

前年度までに研究室で購入していた2種類のPSDセンサについて，
そのPSDセンサの精度を確かめるために同定実験を行った．

\subsection{センサの仕様}
前年度までに購入していた2種類のPSDセンサの仕様を以下に示す．
また，下記2つのセンサを便宜上，順に近距離センサ，遠距離センサと
呼ぶこととする．\\

 \begin{description}
  \item[【シャープ測距モジュール　GP2Y0A21YK】] \mbox{} \\
	     測距範囲：$10〜80\unit{cm}$ \\
	     出力：アナログ電圧出力 \\
	     寸法：$29.5×13×13.5\unit{mm}$ \\
	     電源：$4.5〜5.5\unit{V}$
  \item[【シャープ測距モジュール　GP2Y0A02YK】] \mbox{} \\
	     測距範囲：$20〜150\unit{cm}$ \\
	     出力：アナログ電圧出力 \\
	     寸法：$29.5×13×21.6\unit{mm}$ \\
	     電源：$4.5〜5.5\unit{V}$
 \end{description}


\subsection{実験装置}
PSDセンサの実験を行うため，図\ref{psded}のような実験装置を製作した．
PSDセンサは高さ$20\unit{mm}$の位置にセンサの発光部が左，
受光部が右になるように箱に水平に装着した．
PSDセンサを動作せるのにはArduino Unoを用い，
Arduino IDEのシリアルモニタを用いて出力電圧を測定した．
実験時のセンサとArduinoの配線を図\ref{psdwd}に，
Arduinoのプログラムを付録1に示す．
配線にはブレッドボードを用いた．また，ポールの代わりに，
ポールと同じ形状のスプレー缶を用いた．

\begin{figure}[t]
  \begin{center}
   \includegraphics[scale = 0.8]{picture/psded.eps}
   \caption{PSD実験装置}
   \label{psded}
  \end{center}
\end{figure}

\begin{figure}
 \begin{center}   
  \includegraphics[scale = 0.8]{picture/psdwd.eps}
  \caption{PSDセンサの配線図}
  \label{psdwd}
 \end{center}
\end{figure}


\newpage
\subsection{実験方法}
PSDセンサの距離-出力電圧特性を測定するため以下の手順に従い実験を行った．
\begin{enumerate}
 \item PSDセンサの発光部・受光部の先端を距離$0\unit{cm}$とし，
       近距離センサは$5\unit{cm}$から$100\unit{cm}$まで，
       $5\unit{cm}$ずつスプレー缶を移動させ出力電圧を記録する．
       このとき，スプレー缶の中心はPSDセンサの中心の正面にくるように
       置き測定する．
 \item 先程と同様に，遠距離センサは$5\unit{cm}$から$170\unit{cm}$まで，
       $5\unit{cm}$ずつスプレー缶を移動させ出力電圧を記録する．
\end{enumerate} 

\subsection{実験結果}
縦軸を出力電圧，横軸をPSDセンサ-スプレー缶間の距離とし，
近距離センサの測定結果のグラフを図\ref{psdn}に，
遠距離センサの測定結果のグラフを図\ref{psdf}に示す．
図\ref{psdn}より，近距離センサは出力電圧が$40\unit{cm}$までは
滑らかに減少しており，$40\unit{cm}$からは大きな変化は見られない．
それに対して図\ref{psdf}より，遠距離センサは測距可能範囲内において
出力電圧が$80\unit{cm}$までは滑らかに減少しており，
$80\unit{cm}$からは変化に乏しいことがわかる．
よって，近距離センサでは$40\unit{cm}$以降，遠距離センサでは$80\unit{cm}$以降の距離を算出することが難しくなると考えられる．
ここで，今回のロボットは$40\unit{cm}$以降も距離を計測する必要がある．
従って適当なセンサは，遠距離センサであると考えられる．


\newpage
\begin{figure}[htb]
  \begin{center}
    \includegraphics[width=1.0\hsize]{picture/psdn.eps}
    \caption{近距離センサ}
    \label{psdn}
  \end{center}
\end{figure}

\begin{figure}[H]
  \begin{center}
    \includegraphics[width=1.0\hsize]{picture/psdf.eps}
    \caption{遠距離センサ}
    \label{psdf}
  \end{center}
\end{figure}


\newpage
\subsection{PSDセンサの課題}
今回のRCRにおいて用いるPSDセンサの課題として，
実験により得られた測定値のデータにノイズが入ることが挙げられる．
これを改善するためにフィルタをかけてノイズを除去することを考える．
ここでは以下の2種類のフィルタについてその実用性を考察する．
ただし，それらの検証実験は今後行うものとする．

\subsubsection{平均値フィルタ}
実測値の中で範囲を決めて，その平均値をとるフィルタのことである．
ノイズの影響を小さくすることができるが，フィルタが長くなると応答性能が悪化する．

\subsubsection{メディアンフィルタ(中間値フィルタ)}
奇数個のデータの中間に位置する値をその位置のデータとして
採用するフィルタのことである．スパイクノイズを取り除くのに適しているため，
今回使用するPSDセンサにはこちらのフィルタを用いることが適切であると考えられる．

\input{../kuwano/kuwano.tex}
\input{../Circuit/Circuit02.tex}
\input{../odom/odom.tex}

\newpage

\section{アルゴリズム}
3つのモードを切り替えながら完走する．
 \subsection{直線走行}
 まず最初の直線部分のアルゴリズムである．右斜め前についているPSDセンサが一定時間内にある閾値以上の反応を示す限り直進しする．そして車体右側についている2つのPSDセンサで同一のポールをとらえた時の測定距離の差を用いて車体のズレを検出し，車体角度を調節する．右斜め前についているPSDセンサが一定時間閾値以上の反応を見せなかった場合，右折し消火活動開始区間に入る．
 \subsection{消火エリア内}
火活動開始区間では一番近い入り口から順番にカメラで見ていく．ロボカーの侵入を妨げるポールがない入り口を見つけ次第すぐに消火エリアに入るように設定する．消火エリアに入ったのちすぐに左旋回しポール探索を行う．赤ポールを検出できたらそのポールまで行き消火活動を行う．消火したポールの先にまだ赤ポールがあるなら，そこまで行き消火する．その後Uターンし黄色ポールまでもどり，直線走行をする．一定距離，下に進んだのち左旋回し赤ポールを探索し消火する．これを繰り返し一番下まで探索を繰り返していく．
 \subsection{ゴールまで} 
色ポールに沿って下へ進んでいくが，その黄色ポールが検出できなくなると右旋回しゴールする．


\begin{figure}[hb]
\begin{center}
  \includegraphics[scale = 0.4]{./picture/screen_shot.eps}
 \caption{アルゴリズム}
\end{center}
\end{figure}

\section{今後の予定}
図\ref{fig:schedule}に大まかな今後の予定を示す．
\begin{figure}[tH]
\begin{center}
  \includegraphics[width=1.0\hsize]{./picture/schedule.eps}
 \caption{今後の予定}
 \label{fig:schedule}
\end{center}
\end{figure}



\section{使用物品}
今回のRCRで使用する予定の物品を表\ref{tab:list1}，\ref{tab:list2}に示す．4月26日時点での合計金額は78118円である．
\input{../list/list.tex}

\newpage
\setcounter{page}{1}
\pagestyle{fancy}
\renewcommand{\headrulewidth}{0.0pt}
\rhead{付録\thepage}
\lhead{}
\cfoot{}
\input{./appendix.tex}


\end{document}
